// generator client {
//     provider = "prisma-client-js"
// }

// datasource db {
//     provider = "postgresql"
//     url      = env("DATABASE_URL")
// }

// model User {
//     id String @id @default(nanoid())
// }

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Users {
    id            String          @id @default(nanoid())
    teacher       Teacher?        @relation(fields: [teacherId], references: [id])
    teacherId     String?
    student       Student?        @relation(fields: [studentId], references: [id])
    studentId     String?
    role          Roles           @default(STUDENT)
    groupMessages GroupMessages[]
    createdAt     DateTime        @default(now())
    updatedAt     DateTime        @updatedAt
}

model Teacher {
    id String @id @default(nanoid())

    username    String
    firstName   String
    lastName    String
    fatherName  String
    birthday    DateTime
    gender      gender
    profileImg  String?
    phoneNumber String
    address     String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    users     Users[]

    subjects      Subjects[]
    classes       Class[]
    attendances   Attendance[]
    lessonsTables LessonsTable[]
    lessons       Lesson[]
}

model Subjects {
    id            String         @id @default(nanoid())
    name          String
    teachers      Teacher[]
    lessonsTables LessonsTable[]
    lessons       Lesson[]
    grades        Grades[]
    createdAt     DateTime       @default(now())
    updatedAt     DateTime       @updatedAt
}

model Class {
    id    String @id @default(nanoid())
    grade String

    Student       Student[]
    supervisior   Teacher?       @relation(fields: [supervisiorId], references: [id])
    supervisiorId String?
    lessonsTables LessonsTable[]
    lessons       Lesson[]
    createdAt     DateTime       @default(now())
    updatedAt     DateTime       @updatedAt
}

model Lesson {
    id         String    @id @default(nanoid())
    title      String
    subject    Subjects? @relation(fields: [subjectsId], references: [id])
    subjectsId String?
    class      Class?    @relation(fields: [classId], references: [id])
    classId    String?
    teacher    Teacher?  @relation(fields: [teacherId], references: [id])
    teacherId  String?
    createdAt  DateTime  @default(now())
    updatedAt  DateTime  @updatedAt
}

model Student {
    id       String @id @default(nanoid())
    username String

    firstName   String
    lastName    String
    fatherName  String
    birthday    DateTime
    gender      gender
    profileImg  String?
    phoneNumber String
    address     String

    users       Users[]
    class       Class?       @relation(fields: [classId], references: [id])
    classId     String?
    attendances Attendance[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    grades    Grades[]
}

model Attendance {
    id String @id @default(nanoid())

    studentId String?
    teacherId String?
    student   Student? @relation(fields: [studentId], references: [id])
    teacher   Teacher? @relation(fields: [teacherId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model GroupMessages {
    id       String  @id @default(nanoid())
    content  String?
    videoUrl String?
    imgUrl   String?
    audioUrl String?

    user   Users?  @relation(fields: [userId], references: [id])
    userId String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model LessonsTable {
    id           String @id @default(nanoid())
    lessonsCount Int

    class      Class?     @relation(fields: [classId], references: [id])
    classId    String?
    subject    Subjects?  @relation(fields: [subjectsId], references: [id])
    subjectsId String?
    teacher    Teacher?   @relation(fields: [teacherId], references: [id])
    teacherId  String?
    dayOfWeek  DaysOfWeek
    createdAt  DateTime   @default(now())
    updatedAt  DateTime   @updatedAt
}

model specialAnouncements {
    id        String   @id @default(nanoid())
    content   String
    date      DateTime
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Grades {
    id         String    @id @default(nanoid())
    grade      Int
    subject    Subjects? @relation(fields: [subjectsId], references: [id])
    subjectsId String?
    student    Student?  @relation(fields: [studentId], references: [id])
    studentId  String?
    createdAt  DateTime  @default(now())
    updatedAt  DateTime  @updatedAt
}

enum Roles {
    ADMIN
    TEACHER
    STUDENT
}

enum DaysOfWeek {
    Monday
    Tuesday
    Wednesday
    Thursday
    Friday
    Saturday
}

enum gender {
    MALE
    FEMALE
}

// // O'quvchilar modeli
// model Student {
//     id          String    @id @default(nanoid())
//     firstName   String
//     lastName    String
//     phone       String    @unique
//     email       String?
//     birthDate   DateTime?
//     address     String?
//     parentPhone String?
//     password    String
//     isActive    Boolean   @default(true)
//     createdAt   DateTime  @default(now())
//     updatedAt   DateTime  @updatedAt

//     // Relations
//     enrollments Enrollment[]
//     payments    Payment[]
//     attendances Attendance[]
//     grades      Grade[]
// }

// // O'qituvchilar modeli
// model Teacher {
//     id        String   @id @default(nanoid())
//     firstName String
//     lastName  String
//     phone     String   @unique
//     email     String?
//     specialty String?
//     password  String
//     salary    Float?
//     isActive  Boolean  @default(true)
//     createdAt DateTime @default(now())

//     // Relations
//     groups  Group[]
//     lessons Lesson[]
// }

// // Kurslar modeli
// model Course {
//     id          String   @id @default(nanoid())
//     name        String
//     description String?
//     price       Float
//     duration    Int
//     color       String?
//     isActive    Boolean  @default(true)
//     createdAt   DateTime @default(now())

//     groups Group[]
// }

// // Guruhlar modeli
// model Group {
//     id          String    @id @default(nanoid())
//     name        String
//     courseId    String?
//     teacherId   String?
//     startDate   DateTime
//     endDate     DateTime?
//     schedule    String
//     maxStudents Int       @default(15)
//     isActive    Boolean   @default(true)
//     createdAt   DateTime  @default(now())

//     course      Course?      @relation(fields: [courseId], references: [id])
//     teacher     Teacher?     @relation(fields: [teacherId], references: [id])
//     enrollments Enrollment[]
//     lessons     Lesson[]
// }

// // Ro'yxatdan o'tish modeli
// model Enrollment {
//     id         String           @id @default(nanoid())
//     studentId  String?
//     groupId    String?
//     enrolledAt DateTime         @default(now())
//     status     EnrollmentStatus @default(ACTIVE)

//     student  Student?  @relation(fields: [studentId], references: [id])
//     group    Group?    @relation(fields: [groupId], references: [id])
//     payments Payment[]
// }

// // To'lovlar modeli
// model Payment {
//     id           String        @id @default(nanoid())
//     enrollmentId String?
//     amount       Float
//     paymentDate  DateTime?
//     month        String
//     status       PaymentStatus @default(PENDING)
//     createdAt    DateTime      @default(now())

//     enrollment Enrollment? @relation(fields: [enrollmentId], references: [id])
//     student    Student?    @relation(fields: [studentId], references: [id])
//     studentId  String?
// }

// // Darslar modeli
// model Lesson {
//     id        String   @id @default(nanoid())
//     groupId   String?
//     teacherId String?
//     date      DateTime
//     topic     String?
//     homework  String?
//     createdAt DateTime @default(now())

//     group       Group?       @relation(fields: [groupId], references: [id])
//     teacher     Teacher?     @relation(fields: [teacherId], references: [id])
//     attendances Attendance[]
//     grade       Grade[]
// }

// // Davomat modeli
// model Attendance {
//     id        String           @id @default(nanoid())
//     studentId String?
//     lessonId  String?
//     status    AttendanceStatus @default(PRESENT)
//     note      String?

//     student Student? @relation(fields: [studentId], references: [id])
//     lesson  Lesson?  @relation(fields: [lessonId], references: [id])
// }

// // Baholar modeli
// model Grade {
//     id        String   @id @default(nanoid())
//     studentId String?
//     lessonId  String?
//     grade     Int
//     comment   Decimal
//     createdAt DateTime @default(now())

//     student Student? @relation(fields: [studentId], references: [id])
//     lesson  Lesson?  @relation(fields: [lessonId], references: [id])
// }

// // ENUM lar
// enum EnrollmentStatus {
//     ACTIVE
//     COMPLETED
//     CANCELLED
// }

// enum PaymentStatus {
//     PENDING
//     PAID
//     OVERDUE
//     CANCELLED
// }

// enum AttendanceStatus {
//     PRESENT
//     ABSENT
//     LATE
//     EXCUSED
// }
